
<%!
    #_style="width:200px;"
%>
<%inherit file="../../commons/dialog_selected_cancel.html"/>

<%block name="modal_body">
 <div class="col-md-12">
    <collapse-box class="zb-form-common" title="${get_global_res('data_generate_source','Nguồn phát sinh dữ liệu')}">        
         <div class="col-md-12">
               <div class="form-group zb-form-group">
                            <input type="radio" name="optradio"/>
                             <label class="col-sm-4 zb-form-label">${get_res('get_by_result_aprPeriod','Lấy theo kết quả của kỳ đánh giá')}</label>
                             <div class="col-sm-8">
                                 <input-select data-list="cbbApprovalPeriod" ng-model="entity.apr_now_result_period" data-value="value" data-caption="caption"/>
                             </div>
                         </div>
              </div>
        <br />
        <div class="col-md-12" style="margin-top:40px;">
               <div class="form-group zb-form-group">
                            <input type="checkbox"/>
                             <label class="col-sm-4 zb-form-label">${get_res('exchange_list_present','Thay thế danh sách hiện có')}</label>
                         </div>
              </div>
        </collapse-box>
          </div>
    </%block>

<%block name="modal_script">
<style>
    input[type=radio] {
    width: 20px;
    height: 20px;
}
    input[type=checkbox] {
    width: 25px;
    height: 25px;
}
</style>
<script>
    (function (scope) {

        scope.title = "Phát sinh Danh sách Nhân viên không đánh giá";
        scope.onResizeDialog = onResizeDialog;
        scope.cbbApprovalPeriod = [];



        function onResizeDialog() {
            $dialog.fullScreen();
            scope.col = scope.col == 12 ? 6 : 12;
            scope.col_group = scope.col_group == 6 ? 8 : 6;
        }
        scope.entity = {};
		function _loadCombobox(callback) {
			debugger
                services.api("${get_api_key('app_main.api.TMPER_AprPeriodEmpOut/get_list_distinct_approval_year_and_period')}")
                    .data({})
                    .done()
					.then(function (res) {
						debugger
                        callback(res)
                    })
            
        }

        (function _init_() {
			_loadCombobox(function (res) {
				debugger
				scope.cbbApprovalPeriod = res;
				var period_now =  Re_Map_Period(scope.$parent.$apr_period);
				var year_now = scope.$parent.$apr_year;
				for (var i = 0; i < res.length; i++) {
					if (res[i].apr_period == period_now && res[i].apr_year == year_now) {
						scope.entity.apr_now_result_period = res[i].value;
						console.log('value:', res[i].value);
					}
					scope.$applyAsync();
				}
				
            })
        })();


        scope.$watch('entity.apr_now_result_period', function (val) {
            console.log(val);
		})

function Re_Map_Period(periodStr) {
        debugger
        var numPeriod = 0;
        for (var i = 0; i < 12; i++) {
            if (periodStr === "Tháng " + (i + 1).toString()) {
                numPeriod = i + 1
                return numPeriod;
            }

        }
        for (var j = 13; j <= 16; j++) {
            if (periodStr === "Quý " + (j - 12).toString()) {
                numPeriod = j - 12
                return numPeriod;
            }
        }
        if (periodStr === "6 tháng đầu năm")
            numPeriod = 17;
        else if (periodStr === "6 tháng cuối năm")
            numPeriod = 18;
        else
            numPeriod = 19;
        return numPeriod;
    }
		
    });
</script>

</%block>